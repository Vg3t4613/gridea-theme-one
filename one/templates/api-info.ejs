<%- outputInfo();%><%  -%>
<%
function refineInfo(str){
   return str.replace(/(<(\/?)(\w+)[^>]*>)|(<!--[\s\S]*?-->)/g ,'')//去除html标签如<p></p>和注释
   .replace(/\s+/g,' ')//压缩空格换行等只保留一个空格
}

function outputInfo(){

   //全站信息
   let siteInfo={
      posts:[],//必选，不可更改
      utils:site.utils//必选，不可更改
   };
site.posts.forEach(function(post, index){
   if(!post.hideInList){
      let postInfo={//文章信息，可扩展；
         title:post.title,
         tags:post.tags,
         link:post.link,
         feature:post.feature,
         date:post.date,
         dateFormat:post.dateFormat,
         description:refineInfo(post.description)
      };
      siteInfo.posts.push(postInfo);
   }
})

return JSON.stringify(siteInfo);
}
%>